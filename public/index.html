<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penguin Status - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">
    <style>
    /* Light theme styles */
    [data-theme="light"] {
      --bg-color: #ffffff;
      --card-bg: #f0f8ff;
      --text-color: #4169e1;
      --text-secondary: #6495ed;
      --border-color: #b0c4de;
      --accent-color: #1e90ff;
      --success-color: #28a745;
      --warning-color: #87ceeb;
      --danger-color: #4682b4;
      --hover-bg: #e6f3ff;
    }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                üêß
                Penguin Status
            </a>
            <div class="d-flex align-items-center ms-auto">
                <span class="navbar-text me-3">
                    <i class="fas fa-user me-2"></i>
                    Welcome, <span id="userName">Guest</span>
                </span>
                <button class="theme-toggle me-3" onclick="toggleTheme()" title="Toggle Theme">
                    <i class="fas fa-sun" id="themeIcon"></i>
                </button>
                <button class="btn btn-outline-light btn-sm me-2" onclick="showAddMonitorModal()" style="display: none;">
                    <i class="fas fa-plus me-1"></i>
                    Add Monitor
                </button>
                <button class="btn btn-outline-light btn-sm me-2" id="managerBtn" style="display: none;" onclick="window.location.href='/manager.html'">
                    <i class="fas fa-cog me-1"></i>
                    Manager
                </button>
                <button class="btn btn-outline-light btn-sm me-2" id="loginBtn" onclick="window.location.href='/login.html'">
                    <i class="fas fa-sign-in-alt me-2"></i>
                    Login
                </button>
                <button class="btn btn-outline-light btn-sm" id="logoutBtn" style="display: none;">
                    <i class="fas fa-sign-out-alt me-2"></i>
                    Logout
                </button>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Status Overview -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h4 class="card-title" id="up-count">0</h4>
                                <p class="card-text">Services Up</p>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-check-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-danger text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h4 class="card-title" id="down-count">0</h4>
                                <p class="card-text">Services Down</p>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-times-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-info text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h4 class="card-title" id="uptime-percentage">100%</h4>
                                <p class="card-text">Uptime</p>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-chart-line fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-warning text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h4 class="card-title" id="avg-response">0ms</h4>
                                <p class="card-text">Avg Response</p>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-clock fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overall Status Indicator -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body text-center">
                        <h5 class="card-title mb-3">System Status</h5>
                        <div id="status-indicator">
                            <i class="fas fa-circle text-success"></i> All Systems Operational
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitors List -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-list me-2"></i>
                            Monitors
                        </h5>
                        <div>
                            <button class="btn btn-sm btn-outline-secondary me-2" onclick="refreshMonitors()">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-primary me-2" onclick="testDiscordNotification()" title="Test Discord Notifications">
                                <i class="fab fa-discord"></i>
                            </button>

                            <span class="badge bg-secondary" id="monitor-count">0 monitors</span>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div id="monitors-container">
                            <div class="text-center p-4 text-muted">
                                <i class="fas fa-plus-circle fa-3x mb-3"></i>
                                <p>No monitors configured yet. Click "Add Monitor" to get started.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Monitor Modal -->
    <div class="modal fade" id="addMonitorModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>
                        Add New Monitor
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addMonitorForm">
                        <div class="mb-3">
                            <label for="monitorName" class="form-label">Monitor Name</label>
                            <input type="text" class="form-control" id="monitorName" required style="color: #1f2937 !important;">
                        </div>
                        <div class="mb-3">
                            <label for="monitorType" class="form-label">Monitor Type</label>
                            <select class="form-select" id="monitorType" required style="color: #1f2937 !important;">
                                <option value="">Select type...</option>
                                <option value="http">HTTP - Web Service</option>
                                <option value="https">HTTPS - Secure Web Service</option>
                                <option value="ping">Ping - Network Connectivity</option>
                                <option value="tcp">TCP Port - Service Port Check</option>
                                <option value="dns">DNS - Domain Name Resolution</option>
                                <option value="ftp">FTP - File Transfer Protocol</option>
                                <option value="smtp">SMTP - Email Server</option>
                                <option value="pop3">POP3 - Email Retrieval</option>
                                <option value="imap">IMAP - Email Access</option>
                                <option value="ssh">SSH - Secure Shell</option>
                                <option value="postgresql">PostgreSQL - Database Server</option>
                                <option value="redis">Redis - Cache Server</option>
                                <option value="mongodb">MongoDB - NoSQL Database</option>
                                <option value="websocket">WebSocket - Real-time Connection</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="monitorUrl" class="form-label">URL/Host</label>
                            <input type="text" class="form-control" id="monitorUrl" required style="color: #1f2937 !important;">
                            <div class="form-text">Examples: https://example.com, example.com, 192.168.1.1:80</div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="monitorInterval" class="form-label">Check Interval (seconds)</label>
                                    <input type="number" class="form-control" id="monitorInterval" value="60" min="10" style="color: #1f2937 !important;">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="monitorTimeout" class="form-label">Timeout (seconds)</label>
                                    <input type="number" class="form-control" id="monitorTimeout" value="30" min="5" style="color: #1f2937 !important;">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="addMonitor()">Add Monitor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-key me-2"></i>
                        Change Password
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="changePasswordForm">
                        <div class="mb-3">
                            <label for="currentPassword" class="form-label">Current Password</label>
                            <input type="password" class="form-control" id="currentPassword" required style="color: #1f2937 !important;">
                        </div>
                        <div class="mb-3">
                            <label for="newPassword" class="form-label">New Password</label>
                            <input type="password" class="form-control" id="newPassword" required style="color: #1f2937 !important;">
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm New Password</label>
                            <input type="password" class="form-control" id="confirmPassword" required style="color: #1f2937 !important;">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="changePassword()">Change Password</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Management Modal -->
    <div class="modal fade" id="userManagementModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-users me-2"></i>
                        User Management
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6>Users</h6>
                        <button class="btn btn-primary btn-sm" onclick="showAddUserModal()">
                            <i class="fas fa-plus me-1"></i>
                            Add User
                        </button>
                    </div>
                    <div id="users-container">
                        <div class="text-center p-4 text-muted">
                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                            <p>Loading users...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user-plus me-2"></i>
                        Add New User
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addUserForm">
                        <div class="mb-3">
                            <label for="newUsername" class="form-label">Username</label>
                            <input type="text" class="form-control" id="newUsername" required style="color: #1f2937 !important;">
                        </div>
                        <div class="mb-3">
                            <label for="newUserPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="newUserPassword" required style="color: #1f2937 !important;">
                        </div>

                        <div class="mb-3">
                            <label for="newUserRole" class="form-label">Role</label>
                            <select class="form-select" id="newUserRole" required style="color: #1f2937 !important;">
                                <option value="user">User</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="addUser()">Add User</button>
                </div>
            </div>
        </div>
    </div>



    <!-- Connection Status -->
    <div class="position-fixed bottom-0 end-0 p-3">
        <div id="connection-status" class="alert alert-success alert-dismissible" role="alert" style="display: none;">
            <i class="fas fa-wifi me-2"></i>
            <span id="connection-text">Connected</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="./script.js"></script>
</body>
</html>